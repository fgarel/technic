<?xml version="1.0" encoding="UTF-8"?>

<root>
  <!-- CONFIGURATOR DATA -->
  <descriptor version="3"/> 

  <!-- DEFINE HERE TABLE STRUCTURE -->
  <structure tablename="objet_attribut_topo">
    <field name="rang_service"     type="VARCHAR"/>
    <field name="service"  type="VARCHAR"/>
    <field name="rang_objet"     type="VARCHAR"/>
    <field name="code_sous_theme_aitf"  type="VARCHAR"/>
    <field name="code_objet_sav"     type="VARCHAR"/>
    <field name="code_objet"     type="VARCHAR"/>
    <field name="libelle_objet_commun"  type="VARCHAR"/>
    <field name="libelle_objet_sig"  type="VARCHAR"/>
    <field name="libelle_objet"  type="VARCHAR"/>
    <field name="type_objet"  type="VARCHAR"/>
    <field name="rang_attribut"  type="VARCHAR"/>
    <field name="code_attribut"     type="VARCHAR"/>
    <field name="libelle_attribut"     type="VARCHAR"/>
    <field name="type_attribut_1"  type="VARCHAR"/>
    <field name="type_attribut_2"  type="VARCHAR"/>
    <field name="longueur_attribut"     type="VARCHAR"/>
  </structure>
    
  <!-- WHAT GRAMMAR USE -->
  <!-- ici, on a le choix entre -->
  <!-- mysql -->
  <!-- oracle -->
  <!-- standard -->
  <grammar class="net.sf.csv2sql.grammars.standard.GrammarFactory"/>

  <!-- TEMPORARY STORAGE -->
  <storage class="net.sf.csv2sql.storage.Memory"/>

  <!-- RENDERER CONFIGURATION -->
  <!-- ici, on a le choix entre -->
  <!-- SSqlInsertRenderer -->
  <!-- SqlInsertRendererFromExcel -->
  <render class="net.sf.csv2sql.renders.SqlInsertRendererFromExcel">
    <param name="inputfile"     value="objet_attribut_topo.xls"/>
    <!--optional-->        
    <param name="trimdata"           value="true"/>    
    <param name="suppressheader"     value="true"/>
    <param name="removedoublequotes" value="false"/>
    <!-- decomment for add id autogeneated field -->
    <!--<param name="idGenerator"   value="net.sf.csv2sql.idgenerators.Incremental"/>-->  
    <!--<param name="startrow" value="2"/>-->
    <!--<param name="stoprow" value="4"/>-->
    <!--<param name="presql" value="BEGIN TRANSACTION;"/>-->
    <param name="presql" value="
SELECT drop_table_if_exists ('objet_attribut_topo',false);
CREATE TABLE objet_attribut_topo
(
  rang_service character varying(256),
  service character varying(256),
  rang_objet character varying(256),
  code_sous_theme_aitf character varying(256),
  code_objet_sav character varying(256),
  code_objet character varying(256),
  libelle_objet_commun character varying(256),
  libelle_objet_sig character varying(256),
  libelle_objet character varying(256),
  type_objet character varying(256),
  rang_attribut character varying(256),
  code_attribut character varying(256),
  libelle_attribut character varying(256),
  type_attribut_1 character varying(256),
  type_attribut_2 character varying(256),
  longueur_attribut character varying(256)
) 
WITH OIDS;
"/>
    <!--<param name="postsql" value="COMMIT;"/>-->
    <param name="postsql" value="
VACUUM ANALYSE objet_attribut_topo;
"/>
  </render>
  
  <!-- WRITER CONFIGURATION -->
  <!-- ici, on a le choix entre -->
  <!-- SqlFileWriter -->
  <!-- StandardOutputWriter -->
  <!-- JDBCBatchWriter -->
  <!-- JDBCWriter -->
  <output>
  
    <writerAppender active="true"
        class="net.sf.csv2sql.writers.SqlFileWriter">
        <param name="filename" value="F:\INFO\geomatique\dossiers_en_cours\donnees_topo\excel2sql\objet_attribut_topo.sql"/>
    </writerAppender>
        
    <writerAppender active="true"
        class="net.sf.csv2sql.writers.StandardOutputWriter">
    </writerAppender>
            
    <!-- change parameters and activate it --> 
    <writerAppender active="false"
        class="net.sf.csv2sql.writers.JdbcWriter">
        <param name="driver"    value="org.postgresql.Driver"/>
        <param name="url"       value="jdbc:postgresql://localhost/CatalogueTopo"/>
        <param name="username"  value="fred"/>
                
        <!--optional-->
        <param name="password"  value="fred"/>      
        <!--<param name="commit"    value="false"/>-->        
        <param name="jdbcjar"   value="C:/libre/csvtosql_jdk50/lib/postgresql-8.2-505.jdbc4.jar"/>       
    </writerAppender>        

    <!-- change parameters and activate it -->
    <writerAppender active="false"     
        class="net.sf.csv2sql.writers.JdbcBatchWriter">
        <param name="driver"        value="org.postgresql.Driver"/>
        <param name="url"           value="jdbc:postgresql://localhost/CatalogueTopo"/>
        <param name="username"      value="fred"/>        
        <param name="batchcount"    value="10"/>
        
        <!--optional-->              
        <param name="password"      value="fred"/>        
        <param name="commitbatchcount"  value="0"/>        
        <param name="jdbcjar"       value="/root/myJdbcDriver.jar"/>       
    </writerAppender> 
        
  </output>
  

</root>

